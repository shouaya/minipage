<message>
<div class="R C R0 C0"></div><div class="I R0 C0 S3R0C0 F11"><pagination total={ opts.messageCount } size=10 ></pagination></div>
<div class="R C R3 C1"></div><div class="I R3 C1 S3R0C0 F11"><message-info each={ opts.messages } data={this} ></message-info></div>

<script>
var self = this;
this.page = 1;
this.on('mount', function(){
    this.refresh();
});
refresh(e){
	$('#loadingToast').fadeIn(100);
	$.ajax({
		url : '/line/message?limit=10&offset=' + (this.page-1)*10,
		type : 'GET',
		dataType:"json",
		contentType : 'application/json',
		success : function(data, status) {
			console.log(data);
			opts.messages = data;
			self.update();
		},
		complete : function(xhr, status){
			$('#loadingToast').fadeOut(100);
		},
		error : function(xhr, type) {
			alert('error!')
		}
	});
}
</script>
</message>